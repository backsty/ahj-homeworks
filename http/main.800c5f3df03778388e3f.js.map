{"version":3,"file":"main.800c5f3df03778388e3f.js","mappings":"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","sources":["webpack://helpdesk-system/./src/frontend/js/api.js","webpack://helpdesk-system/./src/frontend/js/Modal.js","webpack://helpdesk-system/./src/frontend/js/TicketView.js","webpack://helpdesk-system/./src/frontend/js/StateManager.js","webpack://helpdesk-system/./src/index.js","webpack://helpdesk-system/./src/frontend/js/app.js"],"sourcesContent":["export default class TicketApi {\n  constructor(baseUrl) {\n    this.baseUrl = baseUrl;\n  }\n\n  async getAllTickets() {\n    const response = await fetch(`${this.baseUrl}?method=allTickets`);\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    return await response.json();\n  }\n\n  async getTicketById(id) {\n    const response = await fetch(`${this.baseUrl}?method=ticketById&id=${id}`);\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    return await response.json();\n  }\n\n  async createTicket(data) {\n    const response = await fetch(`${this.baseUrl}?method=createTicket`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n    return await response.json();\n  }\n\n  async updateTicket(id, data) {\n    const response = await fetch(`${this.baseUrl}?method=updateTicket&id=${id}`, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    return await response.json();\n  }\n\n  async deleteTicket(id) {\n    const response = await fetch(`${this.baseUrl}?method=deleteTicket&id=${id}`, {\n      method: 'DELETE',\n    });\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    return await response.json();\n  }\n};","export default class Modal {\n  constructor() {\n    this.modal = document.createElement('div');\n    this.modal.className = 'modal';\n    this.modal.innerHTML = `\n        <div class=\"modal-content\">\n            <button type=\"button\" class=\"close-btn\" aria-label=\"Закрыть\">\n                <svg class=\"icon\" viewBox=\"0 -960 960 960\">\n                    <path d=\"M256-213.847 213.847-256l224-224-224-224L256-746.153l224 224 224-224L746.153-704l-224 224 224 224L704-213.847l-224-224-224 224Z\"/>\n                </svg>\n            </button>\n            <div class=\"modal-body\"></div>\n        </div>\n    `;\n    document.body.appendChild(this.modal);\n\n    this.closeBtn = this.modal.querySelector('.close-btn');\n    this.modalBody = this.modal.querySelector('.modal-body');\n\n    if (this.closeBtn) {\n      this.closeBtn.addEventListener('click', () => this.close());\n    }\n  }\n\n  show(content) {\n    this.modal.classList.add('active');\n    this.modalBody.innerHTML = content;\n  }\n\n  close() {\n    this.modal.classList.remove('active');\n    setTimeout(() => {\n      this.modalBody.innerHTML = '';\n    }, 300);\n  }\n};","export default class TicketView {\n    constructor(container) {\n        this.container = container;\n        this.tickets = [];\n        this.addEventListeners();\n    }\n\n    renderTickets(tickets) {\n        this.tickets = tickets;\n        this.container.innerHTML = tickets.map(ticket => this.createTicketHTML(ticket)).join('');\n    }\n\n    addEventListeners() {\n        this.container.addEventListener('click', (event) => {\n            // event.preventDefault();\n            const ticket = event.target.closest('.ticket');\n            if (!ticket) return;\n\n            const id = ticket.dataset.id;\n            const target = event.target.closest('button, .status-checkbox, label');\n\n            if (target) {\n                if (target.classList.contains('edit-btn')) {\n                    event.preventDefault();\n                    this.onEditClick?.(id);\n                } else if (target.classList.contains('delete-btn')) {\n                    event.preventDefault();\n                    this.onDeleteClick?.(id);\n                } else if (target.classList.contains('status-checkbox') || target.getAttribute('for')?.startsWith('status-')) {\n                    this.onStatusChange?.(id);\n                }\n            } else if (event.target.closest('.ticket-content')) {\n                event.preventDefault();\n                this.onTicketClick?.(id);\n            }\n        });\n    }\n\n    createTicketHTML(ticket) {\n        const checkboxIcon = ticket.status \n            ? '<path d=\"M382-240 154-468l57-57 171 171 367-367 57 57-424 424Z\"/>'\n            : '<path d=\"M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z\"/>';\n\n        return `\n            <div class=\"ticket\" data-id=\"${ticket.id}\">\n                <div class=\"ticket-status\">\n                    <input type=\"checkbox\" \n                           class=\"status-checkbox\" \n                           id=\"status-${ticket.id}\" \n                           ${ticket.status ? 'checked' : ''}>\n                    <label for=\"status-${ticket.id}\">\n                        <svg class=\"icon\" viewBox=\"0 -960 960 960\">\n                            ${checkboxIcon}\n                        </svg>\n                    </label>\n                </div>\n                <div class=\"ticket-content\">\n                    <h3>${ticket.name}</h3>\n                    <p>Created: ${new Date(ticket.created).toLocaleString()}</p>\n                </div>\n                <div class=\"ticket-controls\">\n                    <button class=\"edit-btn\" title=\"Редактировать\">\n                        <svg class=\"icon\" viewBox=\"0 -960 960 960\">\n                            <path d=\"M200-200h57l391-391-57-57-391 391v57Zm-80 80v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Z\"/>\n                        </svg>\n                    </button>\n                    <button class=\"delete-btn\" title=\"Удалить\">\n                        <svg class=\"icon\" viewBox=\"0 -960 960 960\">\n                            <path d=\"M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Z\"/>\n                        </svg>\n                    </button>\n                </div>\n            </div>\n        `;\n    }\n};","export default class StateManager {\n    constructor() {\n        this.storageKey =  'helpdesk_state';\n    }\n\n    saveState(tickets) {\n        try {\n            localStorage.setItem(this.storageKey, JSON.stringify(tickets));\n        } catch (error) {\n            console.error('Failed to save state:', error);\n        }\n    }\n\n    loadState() {\n        try {\n            const state = localStorage.getItem(this.storageKey);\n            return state ? JSON.parse(state) : [];\n        } catch (error) {\n            console.error('Error loading state:', error);\n        }\n    }\n\n    clearState() {\n        localStorage.removeItem(this.storageKey);\n    }\n};","import './frontend/css/style.css';\nimport App from './frontend/js/app.js';\n\nconst app = new App();\napp.init();\n","import API from './api.js';\nimport Modal from './Modal.js';\nimport TicketView from './TicketView.js';\nimport StateManager from './StateManager.js';\n\nexport default class App {\n    constructor() {\n        this.api = new API('http://localhost:7070/tickets');\n        this.modal = new Modal();\n        this.ticketView = new TicketView(document.querySelector('.container'));\n        this.stateManager = new StateManager();\n\n        document.addEventListener('DOMContentLoaded', () => {\n            this.addTicketBtn = document.querySelector('.add-ticket');\n            if (this.addTicketBtn) {\n                this.registerEvents();\n                this.init();\n            } else {\n                console.error('Add ticket button not found');\n            }\n        });\n    }\n\n    async init() {\n        try {\n            const savedTickets = this.stateManager.loadState();\n            if (savedTickets.length > 0) {\n                this.ticketView.renderTickets(savedTickets);\n            }\n            await this.loadTickets();\n        } catch (error) {\n            console.error('Error initializing app:', error);\n        }\n    }\n\n    registerEvents() {\n        this.addTicketBtn.addEventListener('click', () => this.showCreateTicketModal());\n        this.ticketView.onTicketClick = (id) => this.showTicketDetails(id);\n        this.ticketView.onEditClick = (id) => this.showEditTicketModal(id);\n        this.ticketView.onDeleteClick = (id) => this.showDeleteConfirmation(id);\n        this.ticketView.onStatusChange = (id) => this.toggleTicketStatus(id);\n    }\n\n    async loadTickets() {\n        try {\n            this.showLoading();\n            const tickets = await this.api.getAllTickets();\n            this.ticketView.renderTickets(tickets);\n            this.stateManager.saveState(tickets);\n        } catch (error) {\n            console.error('Error loading tickets', error);\n        } finally {\n            this.hideLoading();\n        }\n    }\n\n    showLoading() {\n        if (document.querySelector('.loading')) return;\n\n        const loader = document.createElement('div');\n        loader.className = 'loading';\n        loader.innerHTML = `\n            <div class=\"lds-grid\">\n                <div></div><div></div><div></div>\n                <div></div><div></div><div></div>\n                <div></div><div></div><div></div>\n            </div>\n        `;\n        document.body.appendChild(loader);\n    }\n\n    hideLoading() {\n        const loader = document.querySelector('.loading');\n        if (loader) loader.remove();\n    }\n\n    showCreateTicketModal() {\n        try {\n            const content = `\n                <form id=\"create-ticket-form\" class=\"ticket-form\">\n                    <h2>Создать тикет</h2>\n                    <input type=\"text\" \n                        name=\"name\" \n                        placeholder=\"Краткое описание\" \n                        required \n                        autocomplete=\"off\">\n                    <textarea name=\"description\" \n                            placeholder=\"Подробное описание\" \n                            required \n                            autocomplete=\"off\"\n                            rows=\"3\"\n                            style=\"resize: none; min-height: 100px;\"\n                            ></textarea>\n                    <div class=\"form-buttons\">\n                        <button type=\"submit\">Создать</button>\n                        <button type=\"button\" class=\"cancel-btn\">Отмена</button>\n                    </div>\n                </form>\n            `;\n            this.modal.show(content);\n\n            const textarea = document.querySelector('textarea[name=\"description\"]');\n            const adjustHeight = () => {\n                textarea.style.height = '100px';\n                textarea.style.height = textarea.scrollHeight + 'px';\n            };\n\n            textarea.addEventListener('input', () => {\n                adjustHeight();\n                textarea.value = textarea.value.replace(/\\n\\s*\\n/g, '\\n');\n            });\n\n            textarea.addEventListener('keydown', (e) => {\n                if (e.key === 'Enter') {\n                    setTimeout(adjustHeight, 0);\n                }\n            });\n\n            adjustHeight();\n\n            const form = document.getElementById('create-ticket-form');\n            const handleSubmit = async (e) => {\n                e.preventDefault();\n                try {\n                    const formData = new FormData(e.target);\n                    await this.createTicket({\n                        name: formData.get('name'),\n                        description: formData.get('description'),\n                        status: false,\n                    });\n                } finally {\n                    form.removeEventListener('submit', handleSubmit);\n                }\n            };\n\n            form.addEventListener('submit', handleSubmit);\n            form.querySelector('.cancel-btn').addEventListener('click', () => {\n                form.reset();\n                this.modal.close();\n            });\n        } catch (error) {\n            console.error('Error in create modal:', error);\n            this.modal.close();\n        }\n    }\n\n    async createTicket(ticket) {\n        try {\n            this.showLoading();\n            await this.api.createTicket(ticket);\n            await this.loadTickets();\n            this.modal.close();\n        } catch (error) {\n            console.error('Error creating ticket', error);\n        } finally {\n            this.hideLoading();\n        }\n    }\n\n    async showTicketDetails(id) {\n        try {\n            this.showLoading();\n            const ticket = await this.api.getTicketById(id);\n            const content = `\n                <div class=\"ticket-details\">\n                    <h2>${ticket.name}</h2>\n                    <p>${ticket.description}</p>\n                    <p>Status: ${ticket.status ? 'Done' : 'In Progress'}</p>\n                    <p>Created: ${new Date(ticket.created).toLocaleString()}</p>\n                </div>\n            `;\n            this.modal.show(content);\n        } catch (error) {\n            console.error('Error loading ticket details', error);\n        } finally {\n            this.hideLoading();\n        }\n    }\n\n    async updateTicket(id, ticket) {\n        try {\n            this.showLoading();\n            await this.api.updateTicket(id, ticket);\n            await this.loadTickets();\n            this.modal.close();\n        } catch (error) {\n            console.error('Error updating ticket', error);\n        } finally {\n            this.hideLoading();\n        }\n    }\n\n    async showEditTicketModal(id) {\n        try {\n            this.showLoading();\n            const ticket = await this.api.getTicketById(id);\n            const content = `\n                <form id=\"edit-ticket-form\" class=\"ticket-form\">\n                    <h2>Редактировать тикет</h2>\n                    <input type=\"text\" \n                        name=\"name\" \n                        value=\"${ticket.name}\" \n                        required \n                        autocomplete=\"off\">\n                    <textarea name=\"description\" \n                            required \n                            autocomplete=\"off\"\n                            rows=\"3\"\n                            style=\"resize: none; min-height: 100px;\"\n                            >${ticket.description}</textarea>\n                    <div class=\"form-buttons\">\n                        <button type=\"submit\">Сохранить</button>\n                        <button type=\"button\" class=\"cancel-btn\">Отмена</button>\n                    </div>\n                </form>\n            `;\n            this.modal.show(content);\n            \n            const textarea = document.querySelector('textarea[name=\"description\"]');\n            const adjustHeight = () => {\n                textarea.style.height = '100px';  // Сбрасываем до минимальной высоты\n                textarea.style.height = textarea.scrollHeight + 'px';\n            };\n\n            textarea.addEventListener('input', () => {\n                adjustHeight();\n                // Убираем двойные переносы строк\n                textarea.value = textarea.value.replace(/\\n\\s*\\n/g, '\\n');\n            });\n\n            // Убираем preventDefault для Enter чтобы работал стандартный перенос\n            textarea.addEventListener('keydown', (e) => {\n                if (e.key === 'Enter') {\n                    setTimeout(adjustHeight, 0);\n                }\n            });\n\n            adjustHeight();\n\n            const form = document.getElementById('edit-ticket-form');\n            const handleSubmit = async (e) => {\n                e.preventDefault();\n                try {\n                    const formData = new FormData(e.target);\n                    await this.updateTicket(id, {\n                        name: formData.get('name'),\n                        description: formData.get('description'),\n                        status: ticket.status,\n                    });\n                } finally {\n                    form.removeEventListener('submit', handleSubmit);\n                }\n            };\n\n            form.addEventListener('submit', handleSubmit);\n            form.querySelector('.cancel-btn').addEventListener('click', () => {\n                form.reset();\n                this.modal.close();\n            });\n        } catch (error) {\n            console.error('Error loading ticket for edit', error);\n            this.modal.close();\n        } finally {\n            this.hideLoading();\n        }\n    }\n\n    showDeleteConfirmation(id) {\n        try {\n            const content = `\n                <div class=\"delete-confirmation\">\n                    <h2>Удалить тикет?</h2>\n                    <div class=\"modal-buttons\">\n                        <button id=\"confirm-delete\" class=\"danger-btn\">Да</button>\n                        <button id=\"cancel-delete\">Отмена</button>\n                    </div>\n                </div>\n            `;\n            this.modal.show(content);\n\n            const confirmBtn = document.getElementById('confirm-delete');\n            const cancelBtn = document.getElementById('cancel-delete');\n\n            const cleanup = () => {\n                confirmBtn?.removeEventListener('click', handleConfirm);\n                cancelBtn?.removeEventListener('click', handleCancel);\n            };\n\n            const handleConfirm = async () => {\n                try {\n                    this.showLoading();\n                    await this.deleteTicket(id);\n                    this.modal.close();\n                } catch (error) {\n                    console.error('Error deleting ticket:', error);\n                } finally {\n                    this.hideLoading();\n                    cleanup();\n                }\n            };\n    \n\n            const handleCancel = () => {\n                this.modal.close();\n                cleanup();\n            };\n\n            confirmBtn?.addEventListener('click', handleConfirm);\n            cancelBtn?.addEventListener('click', handleCancel);\n        } catch (error) {\n            console.error('Error in delete confirmation:', error);\n            this.modal.close();\n        }\n    }\n\n    async deleteTicket(id) {\n        try {\n            this.showLoading();\n            await this.api.deleteTicket(id);\n            await this.loadTickets();\n            this.modal.close();\n        } catch (error) {\n            console.error('Error deleting ticket', error);\n        } finally {\n            this.hideLoading();\n        }\n    }\n\n    async toggleTicketStatus(id) {\n        try {\n            if (document.querySelector('.loading')) return;\n\n            this.showLoading();\n            const ticket = await this.api.getTicketById(id);\n            if (!ticket) throw new Error('Ticket not found');\n            await this.api.updateTicket(id, { ...ticket, status: !ticket.status });\n            await this.loadTickets();\n        } catch (error) {\n            console.error('Error updating ticket status', error);\n        } finally {\n            this.hideLoading();\n        }\n    }\n};"],"names":["TicketApi","constructor","baseUrl","this","getAllTickets","response","fetch","ok","Error","status","json","getTicketById","id","createTicket","data","method","headers","body","JSON","stringify","updateTicket","deleteTicket","Modal","modal","document","createElement","className","innerHTML","appendChild","closeBtn","querySelector","modalBody","addEventListener","close","show","content","classList","add","remove","setTimeout","TicketView","container","tickets","addEventListeners","renderTickets","map","ticket","createTicketHTML","join","event","target","closest","dataset","contains","preventDefault","onEditClick","onDeleteClick","getAttribute","startsWith","onStatusChange","onTicketClick","checkboxIcon","name","Date","created","toLocaleString","StateManager","storageKey","saveState","localStorage","setItem","error","console","loadState","state","getItem","parse","clearState","removeItem","api","API","ticketView","stateManager","addTicketBtn","registerEvents","init","savedTickets","length","loadTickets","showCreateTicketModal","showTicketDetails","showEditTicketModal","showDeleteConfirmation","toggleTicketStatus","showLoading","hideLoading","loader","textarea","adjustHeight","style","height","scrollHeight","value","replace","e","key","form","getElementById","handleSubmit","async","formData","FormData","get","description","removeEventListener","reset","confirmBtn","cancelBtn","cleanup","handleConfirm","handleCancel"],"sourceRoot":""}