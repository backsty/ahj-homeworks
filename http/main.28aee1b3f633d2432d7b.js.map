{"version":3,"file":"main.28aee1b3f633d2432d7b.js","mappings":"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","sources":["webpack://helpdesk-system/./src/frontend/js/api.js","webpack://helpdesk-system/./src/frontend/js/Modal.js","webpack://helpdesk-system/./src/frontend/js/TicketView.js","webpack://helpdesk-system/./src/frontend/js/StateManager.js","webpack://helpdesk-system/./src/index.js","webpack://helpdesk-system/./src/frontend/js/app.js"],"sourcesContent":["export default class TicketApi {\n  constructor() {\n    this.baseUrl = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'\n      ? 'http://localhost:7070/tickets'\n      : 'https://ahj-backend.herokuapp.com/tickets';\n  }\n\n  async fetchWithConfig(url, options = {}) {\n    const defaultOptions = {\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      mode: 'cors',\n      credentials: 'include'\n    };\n\n    const response = await fetch(url, { ...defaultOptions, ...options });\n    \n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    \n    return response.json();\n  }\n\n  async getAllTickets() {\n    try {\n      return await this.fetchWithConfig(`${this.baseUrl}?method=allTickets`);\n    } catch (error) {\n      console.error('Failed to fetch tickets:', error);\n      return [];\n    }\n  }\n\n  async getTicketById(id) {\n    return this.fetchWithConfig(`${this.baseUrl}?method=ticketById&id=${id}`);\n  }\n\n  async createTicket(data) {\n    return this.fetchWithConfig(`${this.baseUrl}?method=createTicket`, {\n      method: 'POST',\n      body: JSON.stringify(data)\n    });\n  }\n\n  async updateTicket(id, data) {\n    return this.fetchWithConfig(`${this.baseUrl}?method=updateTicket&id=${id}`, {\n      method: 'PUT',\n      body: JSON.stringify(data)\n    });\n  }\n\n  async deleteTicket(id) {\n    return this.fetchWithConfig(`${this.baseUrl}?method=deleteTicket&id=${id}`, {\n      method: 'DELETE'\n    });\n  }\n};","export default class Modal {\n  constructor() {\n    this.modal = document.createElement('div');\n    this.modal.className = 'modal';\n    this.modal.innerHTML = `\n        <div class=\"modal-content\">\n            <button type=\"button\" class=\"close-btn\" aria-label=\"Закрыть\">\n                <svg class=\"icon\" viewBox=\"0 -960 960 960\">\n                    <path d=\"M256-213.847 213.847-256l224-224-224-224L256-746.153l224 224 224-224L746.153-704l-224 224 224 224L704-213.847l-224-224-224 224Z\"/>\n                </svg>\n            </button>\n            <div class=\"modal-body\"></div>\n        </div>\n    `;\n    document.body.appendChild(this.modal);\n\n    this.closeBtn = this.modal.querySelector('.close-btn');\n    this.modalBody = this.modal.querySelector('.modal-body');\n\n    if (this.closeBtn) {\n      this.closeBtn.addEventListener('click', () => this.close());\n    }\n  }\n\n  show(content) {\n    this.modal.classList.add('active');\n    this.modalBody.innerHTML = content;\n  }\n\n  close() {\n    this.modal.classList.remove('active');\n    setTimeout(() => {\n      this.modalBody.innerHTML = '';\n    }, 300);\n  }\n};","export default class TicketView {\n    constructor(container) {\n        this.container = container;\n        this.tickets = [];\n        this.addEventListeners();\n    }\n\n    renderTickets(tickets) {\n        this.tickets = tickets;\n        this.container.innerHTML = tickets.map(ticket => this.createTicketHTML(ticket)).join('');\n    }\n\n    addEventListeners() {\n        this.container.addEventListener('click', (event) => {\n            // event.preventDefault();\n            const ticket = event.target.closest('.ticket');\n            if (!ticket) return;\n\n            const id = ticket.dataset.id;\n            const target = event.target.closest('button, .status-checkbox, label');\n\n            if (target) {\n                if (target.classList.contains('edit-btn')) {\n                    event.preventDefault();\n                    this.onEditClick?.(id);\n                } else if (target.classList.contains('delete-btn')) {\n                    event.preventDefault();\n                    this.onDeleteClick?.(id);\n                } else if (target.classList.contains('status-checkbox') || target.getAttribute('for')?.startsWith('status-')) {\n                    this.onStatusChange?.(id);\n                }\n            } else if (event.target.closest('.ticket-content')) {\n                event.preventDefault();\n                this.onTicketClick?.(id);\n            }\n        });\n    }\n\n    createTicketHTML(ticket) {\n        const checkboxIcon = ticket.status \n            ? '<path d=\"M382-240 154-468l57-57 171 171 367-367 57 57-424 424Z\"/>'\n            : '<path d=\"M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z\"/>';\n\n        return `\n            <div class=\"ticket\" data-id=\"${ticket.id}\">\n                <div class=\"ticket-status\">\n                    <input type=\"checkbox\" \n                           class=\"status-checkbox\" \n                           id=\"status-${ticket.id}\" \n                           ${ticket.status ? 'checked' : ''}>\n                    <label for=\"status-${ticket.id}\">\n                        <svg class=\"icon\" viewBox=\"0 -960 960 960\">\n                            ${checkboxIcon}\n                        </svg>\n                    </label>\n                </div>\n                <div class=\"ticket-content\">\n                    <h3>${ticket.name}</h3>\n                    <p>Created: ${new Date(ticket.created).toLocaleString()}</p>\n                </div>\n                <div class=\"ticket-controls\">\n                    <button class=\"edit-btn\" title=\"Редактировать\">\n                        <svg class=\"icon\" viewBox=\"0 -960 960 960\">\n                            <path d=\"M200-200h57l391-391-57-57-391 391v57Zm-80 80v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Z\"/>\n                        </svg>\n                    </button>\n                    <button class=\"delete-btn\" title=\"Удалить\">\n                        <svg class=\"icon\" viewBox=\"0 -960 960 960\">\n                            <path d=\"M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Z\"/>\n                        </svg>\n                    </button>\n                </div>\n            </div>\n        `;\n    }\n};","export default class StateManager {\n    constructor() {\n        this.storageKey =  'helpdesk_state';\n    }\n\n    saveState(tickets) {\n        try {\n            localStorage.setItem(this.storageKey, JSON.stringify(tickets));\n        } catch (error) {\n            console.error('Failed to save state:', error);\n        }\n    }\n\n    loadState() {\n        try {\n            const state = localStorage.getItem(this.storageKey);\n            return state ? JSON.parse(state) : [];\n        } catch (error) {\n            console.error('Error loading state:', error);\n        }\n    }\n\n    clearState() {\n        localStorage.removeItem(this.storageKey);\n    }\n};","import './frontend/css/style.css';\nimport App from './frontend/js/app.js';\n\nconst app = new App();\napp.init();\n","import API from './api.js';\nimport Modal from './Modal.js';\nimport TicketView from './TicketView.js';\nimport StateManager from './StateManager.js';\n\nexport default class App {\n    constructor() {\n        this.api = new API();\n        this.modal = new Modal();\n        this.ticketView = new TicketView(document.querySelector('.container'));\n        this.stateManager = new StateManager();\n\n        document.addEventListener('DOMContentLoaded', () => {\n            this.addTicketBtn = document.querySelector('.add-ticket');\n            if (this.addTicketBtn) {\n                this.registerEvents();\n                this.init();\n            } else {\n                console.error('Add ticket button not found');\n            }\n        });\n    }\n\n    async init() {\n        try {\n            const savedTickets = this.stateManager.loadState();\n            if (savedTickets.length > 0) {\n                this.ticketView.renderTickets(savedTickets);\n            }\n            await this.loadTickets();\n        } catch (error) {\n            console.error('Error initializing app:', error);\n        }\n    }\n\n    registerEvents() {\n        this.addTicketBtn.addEventListener('click', () => this.showCreateTicketModal());\n        this.ticketView.onTicketClick = (id) => this.showTicketDetails(id);\n        this.ticketView.onEditClick = (id) => this.showEditTicketModal(id);\n        this.ticketView.onDeleteClick = (id) => this.showDeleteConfirmation(id);\n        this.ticketView.onStatusChange = (id) => this.toggleTicketStatus(id);\n    }\n\n    async loadTickets() {\n        try {\n            this.showLoading();\n            const tickets = await this.api.getAllTickets();\n            this.ticketView.renderTickets(tickets);\n            this.stateManager.saveState(tickets);\n        } catch (error) {\n            console.error('Error loading tickets', error);\n        } finally {\n            this.hideLoading();\n        }\n    }\n\n    showLoading() {\n        if (document.querySelector('.loading')) return;\n\n        const loader = document.createElement('div');\n        loader.className = 'loading';\n        loader.innerHTML = `\n            <div class=\"lds-grid\">\n                <div></div><div></div><div></div>\n                <div></div><div></div><div></div>\n                <div></div><div></div><div></div>\n            </div>\n        `;\n        document.body.appendChild(loader);\n    }\n\n    hideLoading() {\n        const loader = document.querySelector('.loading');\n        if (loader) loader.remove();\n    }\n\n    showCreateTicketModal() {\n        try {\n            const content = `\n                <form id=\"create-ticket-form\" class=\"ticket-form\">\n                    <h2>Создать тикет</h2>\n                    <input type=\"text\" \n                        name=\"name\" \n                        placeholder=\"Краткое описание\" \n                        required \n                        autocomplete=\"off\">\n                    <textarea name=\"description\" \n                            placeholder=\"Подробное описание\" \n                            required \n                            autocomplete=\"off\"\n                            rows=\"3\"\n                            style=\"resize: none; min-height: 100px;\"\n                            ></textarea>\n                    <div class=\"form-buttons\">\n                        <button type=\"submit\">Создать</button>\n                        <button type=\"button\" class=\"cancel-btn\">Отмена</button>\n                    </div>\n                </form>\n            `;\n            this.modal.show(content);\n\n            const textarea = document.querySelector('textarea[name=\"description\"]');\n            const adjustHeight = () => {\n                textarea.style.height = '100px';\n                textarea.style.height = textarea.scrollHeight + 'px';\n            };\n\n            textarea.addEventListener('input', () => {\n                adjustHeight();\n                textarea.value = textarea.value.replace(/\\n\\s*\\n/g, '\\n');\n            });\n\n            textarea.addEventListener('keydown', (e) => {\n                if (e.key === 'Enter') {\n                    setTimeout(adjustHeight, 0);\n                }\n            });\n\n            adjustHeight();\n\n            const form = document.getElementById('create-ticket-form');\n            const handleSubmit = async (e) => {\n                e.preventDefault();\n                try {\n                    const formData = new FormData(e.target);\n                    await this.createTicket({\n                        name: formData.get('name'),\n                        description: formData.get('description'),\n                        status: false,\n                    });\n                } finally {\n                    form.removeEventListener('submit', handleSubmit);\n                }\n            };\n\n            form.addEventListener('submit', handleSubmit);\n            form.querySelector('.cancel-btn').addEventListener('click', () => {\n                form.reset();\n                this.modal.close();\n            });\n        } catch (error) {\n            console.error('Error in create modal:', error);\n            this.modal.close();\n        }\n    }\n\n    async createTicket(ticket) {\n        try {\n            this.showLoading();\n            await this.api.createTicket(ticket);\n            await this.loadTickets();\n            this.modal.close();\n        } catch (error) {\n            console.error('Error creating ticket', error);\n        } finally {\n            this.hideLoading();\n        }\n    }\n\n    async showTicketDetails(id) {\n        try {\n            this.showLoading();\n            const ticket = await this.api.getTicketById(id);\n            const content = `\n                <div class=\"ticket-details\">\n                    <h2>${ticket.name}</h2>\n                    <p>${ticket.description}</p>\n                    <p>Status: ${ticket.status ? 'Done' : 'In Progress'}</p>\n                    <p>Created: ${new Date(ticket.created).toLocaleString()}</p>\n                </div>\n            `;\n            this.modal.show(content);\n        } catch (error) {\n            console.error('Error loading ticket details', error);\n        } finally {\n            this.hideLoading();\n        }\n    }\n\n    async updateTicket(id, ticket) {\n        try {\n            this.showLoading();\n            await this.api.updateTicket(id, ticket);\n            await this.loadTickets();\n            this.modal.close();\n        } catch (error) {\n            console.error('Error updating ticket', error);\n        } finally {\n            this.hideLoading();\n        }\n    }\n\n    async showEditTicketModal(id) {\n        try {\n            this.showLoading();\n            const ticket = await this.api.getTicketById(id);\n            const content = `\n                <form id=\"edit-ticket-form\" class=\"ticket-form\">\n                    <h2>Редактировать тикет</h2>\n                    <input type=\"text\" \n                        name=\"name\" \n                        value=\"${ticket.name}\" \n                        required \n                        autocomplete=\"off\">\n                    <textarea name=\"description\" \n                            required \n                            autocomplete=\"off\"\n                            rows=\"3\"\n                            style=\"resize: none; min-height: 100px;\"\n                            >${ticket.description}</textarea>\n                    <div class=\"form-buttons\">\n                        <button type=\"submit\">Сохранить</button>\n                        <button type=\"button\" class=\"cancel-btn\">Отмена</button>\n                    </div>\n                </form>\n            `;\n            this.modal.show(content);\n            \n            const textarea = document.querySelector('textarea[name=\"description\"]');\n            const adjustHeight = () => {\n                textarea.style.height = '100px';  // Сбрасываем до минимальной высоты\n                textarea.style.height = textarea.scrollHeight + 'px';\n            };\n\n            textarea.addEventListener('input', () => {\n                adjustHeight();\n                // Убираем двойные переносы строк\n                textarea.value = textarea.value.replace(/\\n\\s*\\n/g, '\\n');\n            });\n\n            // Убираем preventDefault для Enter чтобы работал стандартный перенос\n            textarea.addEventListener('keydown', (e) => {\n                if (e.key === 'Enter') {\n                    setTimeout(adjustHeight, 0);\n                }\n            });\n\n            adjustHeight();\n\n            const form = document.getElementById('edit-ticket-form');\n            const handleSubmit = async (e) => {\n                e.preventDefault();\n                try {\n                    const formData = new FormData(e.target);\n                    await this.updateTicket(id, {\n                        name: formData.get('name'),\n                        description: formData.get('description'),\n                        status: ticket.status,\n                    });\n                } finally {\n                    form.removeEventListener('submit', handleSubmit);\n                }\n            };\n\n            form.addEventListener('submit', handleSubmit);\n            form.querySelector('.cancel-btn').addEventListener('click', () => {\n                form.reset();\n                this.modal.close();\n            });\n        } catch (error) {\n            console.error('Error loading ticket for edit', error);\n            this.modal.close();\n        } finally {\n            this.hideLoading();\n        }\n    }\n\n    showDeleteConfirmation(id) {\n        try {\n            const content = `\n                <div class=\"delete-confirmation\">\n                    <h2>Удалить тикет?</h2>\n                    <div class=\"modal-buttons\">\n                        <button id=\"confirm-delete\" class=\"danger-btn\">Да</button>\n                        <button id=\"cancel-delete\">Отмена</button>\n                    </div>\n                </div>\n            `;\n            this.modal.show(content);\n\n            const confirmBtn = document.getElementById('confirm-delete');\n            const cancelBtn = document.getElementById('cancel-delete');\n\n            const cleanup = () => {\n                confirmBtn?.removeEventListener('click', handleConfirm);\n                cancelBtn?.removeEventListener('click', handleCancel);\n            };\n\n            const handleConfirm = async () => {\n                try {\n                    this.showLoading();\n                    await this.deleteTicket(id);\n                    this.modal.close();\n                } catch (error) {\n                    console.error('Error deleting ticket:', error);\n                } finally {\n                    this.hideLoading();\n                    cleanup();\n                }\n            };\n    \n\n            const handleCancel = () => {\n                this.modal.close();\n                cleanup();\n            };\n\n            confirmBtn?.addEventListener('click', handleConfirm);\n            cancelBtn?.addEventListener('click', handleCancel);\n        } catch (error) {\n            console.error('Error in delete confirmation:', error);\n            this.modal.close();\n        }\n    }\n\n    async deleteTicket(id) {\n        try {\n            this.showLoading();\n            await this.api.deleteTicket(id);\n            await this.loadTickets();\n            this.modal.close();\n        } catch (error) {\n            console.error('Error deleting ticket', error);\n        } finally {\n            this.hideLoading();\n        }\n    }\n\n    async toggleTicketStatus(id) {\n        try {\n            if (document.querySelector('.loading')) return;\n\n            this.showLoading();\n            const ticket = await this.api.getTicketById(id);\n            if (!ticket) throw new Error('Ticket not found');\n            await this.api.updateTicket(id, { ...ticket, status: !ticket.status });\n            await this.loadTickets();\n        } catch (error) {\n            console.error('Error updating ticket status', error);\n        } finally {\n            this.hideLoading();\n        }\n    }\n};"],"names":["TicketApi","constructor","this","baseUrl","window","location","hostname","fetchWithConfig","url","options","response","fetch","headers","mode","credentials","ok","Error","status","json","getAllTickets","error","console","getTicketById","id","createTicket","data","method","body","JSON","stringify","updateTicket","deleteTicket","Modal","modal","document","createElement","className","innerHTML","appendChild","closeBtn","querySelector","modalBody","addEventListener","close","show","content","classList","add","remove","setTimeout","TicketView","container","tickets","addEventListeners","renderTickets","map","ticket","createTicketHTML","join","event","target","closest","dataset","contains","preventDefault","onEditClick","onDeleteClick","getAttribute","startsWith","onStatusChange","onTicketClick","checkboxIcon","name","Date","created","toLocaleString","StateManager","storageKey","saveState","localStorage","setItem","loadState","state","getItem","parse","clearState","removeItem","api","API","ticketView","stateManager","addTicketBtn","registerEvents","init","savedTickets","length","loadTickets","showCreateTicketModal","showTicketDetails","showEditTicketModal","showDeleteConfirmation","toggleTicketStatus","showLoading","hideLoading","loader","textarea","adjustHeight","style","height","scrollHeight","value","replace","e","key","form","getElementById","handleSubmit","async","formData","FormData","get","description","removeEventListener","reset","confirmBtn","cancelBtn","cleanup","handleConfirm","handleCancel"],"sourceRoot":""}