{"version":3,"file":"main.eb257ecf7650a97f3c62.js","mappings":"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","sources":["webpack://credit-card-validator/webpack/bootstrap","webpack://credit-card-validator/webpack/runtime/publicPath","webpack://credit-card-validator/./src/js/utils/constants.js","webpack://credit-card-validator/./src/js/services/cardTypeDetector.js","webpack://credit-card-validator/./src/js/services/cardValidation.js","webpack://credit-card-validator/./src/js/components/CardValidator.js","webpack://credit-card-validator/./src/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","__webpack_require__.p = \"/ahj-homeworks/testing/\";","import visaImg from '../../img/visa.png';\nimport mastercardImg from '../../img/mastercard.png';\nimport mirImg from '../../img/mir.png';\n\nexport const CARD_PATTERNS = {\n  VISA: {\n    pattern: /^4/,\n    lengths: [13, 16],\n    name: 'visa',\n  },\n  MASTERCARD: {\n    pattern: /^5[1-5]/,\n    lengths: [16],\n    name: 'mastercard',\n  },\n  MIR: {\n    pattern: /^220[0-4]/,\n    lengths: [16],\n    name: 'mir',\n  },\n};\n\nexport const CSS_CLASSES = {\n  CARD_VALIDATOR: 'card-validator',\n  CARD_IMAGES: 'card-images',\n  CARD_IMAGE: 'card-image',\n  CARD_INPUT: 'card-input',\n  VALIDATE_BUTTON: 'validate-btn',\n  ACTIVE: 'active',\n  INVALID: 'invalid',\n  VALID: 'valid',\n};\n\nexport const CARD_IMAGES = {\n  visa: visaImg,\n  mastercard: mastercardImg,\n  mir: mirImg,\n};\n\nexport const MESSAGES = {\n  VALID_CARD: 'Номер карты валиден',\n  INVALID_CARD: 'Неверный номер карты',\n  UNKNOWN_TYPE: 'Неизвестный тип карты',\n};\n\nexport const INPUT_RESTRICTIONS = {\n  MAX_LENGTH: 19,\n  CHUNK_SIZE: 4,\n};","import { CARD_PATTERNS } from '../utils/constants.js';\n\nexport default class CardTypeDetector {\n  detectCardType(number) {\n    const cleanNumber = number.replace(/\\D/g, '');\n    \n    for (const [type, config] of Object.entries(CARD_PATTERNS)) {\n      if (config.pattern.test(cleanNumber) && \n          config.lengths.includes(cleanNumber.length)) {\n        return config.name;\n      }\n    }\n    return null;\n  }\n}","export default class CardValidation {\n  validateCard(number) {\n    if (!number || number.length < 13) {\n      return false;\n    }\n    return this.luhnAlgorithm(number);\n  }\n\n  luhnAlgorithm(number) {\n    const digits = number.replace(/\\D/g, '');\n    let sum = 0;\n    let isEven = false;\n\n    for (let i = digits.length - 1; i >= 0; i--) {\n      let digit = parseInt(digits[i], 10);\n\n      if (isEven) {\n        digit *= 2;\n        if (digit > 9) {\n          digit -= 9;\n        }\n      }\n\n      sum += digit;\n      isEven = !isEven;\n    }\n\n    return sum % 10 === 0;\n  }\n}","import { CSS_CLASSES, CARD_IMAGES, MESSAGES, INPUT_RESTRICTIONS } from '../utils/constants.js';\nimport CardTypeDetector from '../services/cardTypeDetector.js';\nimport Validator from '../services/cardValidation.js';\n\nexport default class CardValidator {\n  constructor(container) {\n    if (!container) {\n      throw new Error('Container element is required');\n    }\n    this.container = container;\n    this.input = null;\n    this.cardimage = {};\n    this.validator = new Validator();\n    this.typeDetector = new CardTypeDetector();\n\n    this.init();\n  }\n\n  init() {\n    this.renderWidget();\n    this.setupListeners();\n  }\n\n  renderWidget() {\n    this.container.innerHTML = `\n      <div class=\"${CSS_CLASSES.CARD_VALIDATOR}\">\n        <div class=\"${CSS_CLASSES.CARD_IMAGES}\">\n          ${Object.entries(CARD_IMAGES).map(([type, src]) => `\n            <img src=\"${src}\" \n                 data-type=\"${type}\" \n                 class=\"${CSS_CLASSES.CARD_IMAGE}\"\n                 alt=\"${type}\"\n            >\n          `).join('')}\n        </div>\n        <input type=\"text\" \n               class=\"${CSS_CLASSES.CARD_INPUT}\"\n               maxlength=\"${INPUT_RESTRICTIONS.MAX_LENGTH}\"\n               placeholder=\"Enter card number\">\n        <button class=\"${CSS_CLASSES.VALIDATE_BUTTON}\">Validate</button>\n      </div>\n    `;\n\n    // this.container.innerHTML = markup;\n    this.input = this.container.querySelector(`.${CSS_CLASSES.CARD_INPUT}`);\n    this.cardImages  = Array.from(this.container.querySelectorAll(`.${CSS_CLASSES.CARD_IMAGE}`));\n  }\n\n  setupListeners() {\n    this.input.addEventListener('input', (e) => this.handleInput(e));\n    this.container.querySelector(`.${CSS_CLASSES.VALIDATE_BUTTON}`)\n      .addEventListener('click', () => this.validateCard());\n  }\n\n  handleInput(e) {\n    let value = e.target.value.replace(/\\D/g, '');\n\n    // Форматирование ввода по чанкам\n    const chunks = [];\n    for (let i = 0; i < value.length; i += INPUT_RESTRICTIONS.CHUNK_SIZE) {\n      chunks.push(value.slice(i, i + INPUT_RESTRICTIONS.CHUNK_SIZE));\n    }\n    this.input.value = chunks.join(' ');\n\n    const cardType = this.typeDetector.detectCardType(value);\n    this.highlightCardType(cardType);\n  }\n\n  \n  highlightCardType(type) {\n    this.cardImages.forEach(img => {\n      const isActive = img.dataset.type === type;\n      img.classList.toggle(CSS_CLASSES.ACTIVE, isActive);\n    });\n  }\n  \n  validateCard() {\n    const number = this.input.value.replace(/\\D/g, '');\n\n    if (!number) {\n      this.showValidationResult(false);\n      return;\n    }\n\n    if (number.length < 13) {\n      this.showValidationResult(false);\n      return;\n    }\n\n    const isValid = this.validator.validateCard(number);\n    this.showValidationResult(isValid);\n  }\n\n  showValidationResult(isValid) {\n    const message = isValid ? MESSAGES.VALID_CARD : MESSAGES.INVALID_CARD;\n    this.input.classList.toggle(CSS_CLASSES.VALID, isValid);\n    this.input.classList.toggle(CSS_CLASSES.INVALID, !isValid);\n    alert(message);\n  }\n}","import './css/style.css';\nimport CardValidator from './js/components/CardValidator.js';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const container = document.getElementById('root');\n  new CardValidator(container);\n});"],"names":["__webpack_require__","CARD_PATTERNS","VISA","pattern","lengths","name","MASTERCARD","MIR","CSS_CLASSES","CARD_IMAGES","visa","visaImg","mastercard","mastercardImg","mir","mirImg","MESSAGES","INPUT_RESTRICTIONS","CardTypeDetector","detectCardType","number","cleanNumber","replace","type","config","Object","entries","test","includes","length","CardValidation","validateCard","this","luhnAlgorithm","digits","sum","isEven","i","digit","parseInt","CardValidator","constructor","container","Error","input","cardimage","validator","Validator","typeDetector","init","renderWidget","setupListeners","innerHTML","map","src","join","querySelector","cardImages","Array","from","querySelectorAll","addEventListener","e","handleInput","value","target","chunks","push","slice","cardType","highlightCardType","forEach","img","isActive","dataset","classList","toggle","showValidationResult","isValid","message","alert","document","getElementById"],"sourceRoot":""}